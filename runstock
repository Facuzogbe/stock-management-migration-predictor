#!/bin/bash

# Colores para la terminal
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
NC='\033[0m' # No Color

# Logo ASCII de StockManager
echo -e "${CYAN}"
echo "   _____ _             _    __  __                                   "
echo "  / ____| |           | |  |  \/  |                                  "
echo " | (___ | |_ ___   ___| | _| \  / | __ _ _ __   __ _  __ _  ___ _ __ "
echo "  \___ \| _/ _ \ / __| |/ / |\/| |/ _\` | ' \ / \` |/ _\` |/ _ \ '_|"
echo "  ___) | || () | (|   <| |  | | (| | | | | (| | (_| |  __/ |   "
echo " |/ \\/ \||\\|  ||\,|| ||\,|\, |\|_|   "
echo "                                                       __/ |          "
echo "                                                      |_/           "
echo -e "${NC}"

# ConfiguraciÃ³n del entorno
export FLASK_APP=src/main.py
export FLASK_ENV=development
export PYTHONPATH=.

# InformaciÃ³n del sistema
echo -e "${YELLOW}âš™  ConfiguraciÃ³n inicial${NC}"
echo -e "${GREEN}ðŸ–¥  Sistema:${NC} $(uname -srm)"
echo -e "${GREEN}ðŸ Python:${NC} $(python3 --version | cut -d' ' -f2)"
echo -e "${GREEN}ðŸ“¦ Entorno virtual:${NC} ${VIRTUAL_ENV:-No activo}"
echo -e "${GREEN}ðŸ“‚ Directorio:${NC} $(pwd)"

# VerificaciÃ³n de dependencias
echo -e "\n${YELLOW}ðŸ” Verificando dependencias...${NC}"
if [ -f "requirements.txt" ]; then
    pip install -r requirements.txt
else
    echo -e "${RED}âŒ No se encontrÃ³ requirements.txt${NC}"
fi

# Iniciar la aplicaciÃ³n
echo -e "\n${BLUE}ðŸš€ Iniciando StockManager...${NC}"
echo -e "${CYAN}ðŸŒ Servidor Flask disponible en: http://127.0.0.1:5000/${NC}"
echo -e "${YELLOW}ðŸ›‘ Presiona Ctrl+C para detener la aplicaciÃ³n${NC}\n"

python3 src/main.py 