{% extends "base.html" %}

{% block title %}Nuevo Movimiento{% endblock %}

{% block content %}
<h2>Registrar Movimiento</h2>

<a href="{{ url_for('movimientos.index') }}">‚Üê Volver al listado</a>

<form method="POST" action="{{ url_for('movimientos.nuevo_movimiento') }}">
    <div class="mb-3">
        <label for="producto_id" class="form-label">Producto:</label>
        <select name="producto_id" id="producto_id" class="form-select" required>
            <option value="" disabled selected>Seleccionar producto</option>
            {% for producto in productos %}
            <option value="{{ producto.product_id }}">{{ producto.product_name }} (SKU: {{ producto.sku }})</option>
            {% else %}
            <option disabled>No hay productos disponibles</option>
            {% endfor %}
        </select>
    </div>

    <!-- Resto del formulario se mantiene igual -->
    <div class="mb-3">
        <label for="tipo" class="form-label">Tipo de movimiento:</label>
        <select name="tipo" id="tipo" class="form-select" required>
            <option value="entrada">Entrada</option>
            <option value="salida">Salida</option>
        </select>
    </div>

    <div class="mb-3">
        <label for="cantidad" class="form-label">Cantidad:</label>
        <input type="number" name="cantidad" id="cantidad" class="form-control" required min="1" />
    </div>

    <button type="submit" class="btn btn-success">Registrar</button>
</form>

<!-- Mensajes flash -->
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <div class="mt-3">
            {% for category, message in messages %}
                <div class="alert alert-{{ 'danger' if category == 'error' else 'success' }}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}
{% endwith %}

{% endblock %}